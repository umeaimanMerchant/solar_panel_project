[2025-11-08 13:35:38,629: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:35:38,630: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-11-08 13:35:38,631: INFO: common: yaml file: params.yaml loaded successfully]
[2025-11-08 13:35:38,632: INFO: common: created directory at: artifacts]
[2025-11-08 13:35:38,632: ERROR: stage_2_data_transformation: "'ConfigBox' object has no attribute 'data_transformation'"]
Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 14, in main
    data_transformation_config = config.get_data_transformation_config()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/config/configuration.py", line 35, in get_data_transformation_config
    config = self.config.data_transformation
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "box/config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'data_transformation'"
[2025-11-08 13:47:56,637: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:47:56,639: INFO: common: created directory at: artifacts]
[2025-11-08 13:47:56,639: ERROR: stage_2_data_transformation: "'ConfigBox' object has no attribute 'data_transformation'"]
Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 14, in main
    data_transformation_config = config.get_data_transformation_config()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/config/configuration.py", line 35, in get_data_transformation_config
    config = self.config.data_transformation
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "box/config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'data_transformation'"
[2025-11-08 13:48:11,475: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:48:11,477: INFO: common: created directory at: artifacts]
[2025-11-08 13:48:11,477: ERROR: stage_2_data_transformation: "'ConfigBox' object has no attribute 'data_transformation'"]
Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'data_transformation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'data_transformation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 14, in main
    data_transformation_config = config.get_data_transformation_config()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/config/configuration.py", line 35, in get_data_transformation_config
    config = self.config.data_transformation
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "box/config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'data_transformation'"
[2025-11-08 13:49:10,431: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:49:10,433: INFO: common: created directory at: artifacts]
[2025-11-08 13:49:10,433: ERROR: stage_2_data_transformation: "'ConfigBox' object has no attribute 'selected_columns'"]
Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'selected_columns'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'selected_columns'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'selected_columns'. Did you mean: 'selected_features'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'selected_columns'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'selected_columns'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'selected_columns'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'selected_columns'. Did you mean: 'selected_features'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 14, in main
    data_transformation_config = config.get_data_transformation_config()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/config/configuration.py", line 41, in get_data_transformation_config
    selected_columns=config.selected_columns
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "box/config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'selected_columns'". Did you mean: 'selected_features'?
[2025-11-08 13:49:49,955: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:49:49,956: INFO: common: created directory at: artifacts]
[2025-11-08 13:49:49,956: ERROR: stage_2_data_transformation: Argument path of type <class 'str'> to <function load_data at 0x108ebb920> does not match annotation type <class 'pathlib.Path'>]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 16, in main
    data_loaded = load_data(data_transformation_config.transformed_data_file)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/ensure/main.py", line 870, in __call__
    raise EnsureError(msg.format(arg=arg, f=self.f, t=templ, valt=type(value)))
ensure.main.EnsureError: Argument path of type <class 'str'> to <function load_data at 0x108ebb920> does not match annotation type <class 'pathlib.Path'>
[2025-11-08 13:52:16,386: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:52:16,389: INFO: common: created directory at: artifacts]
[2025-11-08 13:52:16,389: ERROR: stage_2_data_transformation: Argument path of type <class 'str'> to <function load_data at 0x1080a3920> does not match annotation type <class 'pathlib.Path'>]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 16, in main
    data_loaded = load_data(data_transformation_config.transformed_data_file)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/ensure/main.py", line 870, in __call__
    raise EnsureError(msg.format(arg=arg, f=self.f, t=templ, valt=type(value)))
ensure.main.EnsureError: Argument path of type <class 'str'> to <function load_data at 0x1080a3920> does not match annotation type <class 'pathlib.Path'>
[2025-11-08 13:53:10,950: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:53:10,951: INFO: common: created directory at: artifacts]
[2025-11-08 13:53:10,952: ERROR: stage_2_data_transformation: [Errno 2] No such file or directory: 'artifacts/data/transformed_data.csv']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 16, in main
    data_loaded = load_data(data_transformation_config.transformed_data_file)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/ensure/main.py", line 872, in __call__
    return_val = self.f(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/utils/common.py", line 140, in load_data
    df = pd.read_csv(path)
         ^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'artifacts/data/transformed_data.csv'
[2025-11-08 13:54:11,244: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:54:11,245: INFO: common: created directory at: artifacts]
[2025-11-08 13:54:11,246: ERROR: stage_2_data_transformation: [Errno 2] No such file or directory: 'artifacts/data_ingestion/Solar_Footprints.csv']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 16, in main
    data_loaded = load_data(data_transformation_config.source_data_file)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/ensure/main.py", line 872, in __call__
    return_val = self.f(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/utils/common.py", line 140, in load_data
    df = pd.read_csv(path)
         ^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'artifacts/data_ingestion/Solar_Footprints.csv'
[2025-11-08 13:54:36,916: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:54:36,917: INFO: common: created directory at: artifacts]
[2025-11-08 13:54:36,929: ERROR: stage_2_data_transformation: "['Region'] not in index"]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 50, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 20, in main
    data_loaded = data_transformation.columns_selector(data_loaded, columns_to_select)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/data_transformation.py", line 19, in columns_selector
    return data[selected_columns]
           ~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['Region'] not in index"
[2025-11-08 13:59:23,424: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 13:59:23,426: INFO: common: created directory at: artifacts]
[2025-11-08 13:59:23,436: ERROR: stage_2_data_transformation: DataTransformation.transform_county_to_region() got multiple values for argument 'county_col']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 52, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 19, in main
    data_loaded = data_transformation.transform_county_to_region(data_loaded, county_col='County')
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DataTransformation.transform_county_to_region() got multiple values for argument 'county_col'
[2025-11-08 14:00:05,199: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:00:05,200: INFO: common: created directory at: artifacts]
[2025-11-08 14:00:05,208: ERROR: stage_2_data_transformation: DataTransformation.transform_county_to_region() got multiple values for argument 'county_col']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 52, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 19, in main
    data_loaded = data_transformation.transform_county_to_region(data_loaded, county_col="County")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DataTransformation.transform_county_to_region() got multiple values for argument 'county_col'
[2025-11-08 14:00:51,308: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:00:51,309: INFO: common: created directory at: artifacts]
[2025-11-08 14:00:51,317: ERROR: stage_2_data_transformation: DataTransformation.transform_county_to_region() takes 1 positional argument but 2 were given]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 52, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 19, in main
    data_loaded = data_transformation.transform_county_to_region(data_loaded)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DataTransformation.transform_county_to_region() takes 1 positional argument but 2 were given
[2025-11-08 14:08:54,333: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:08:54,335: INFO: common: created directory at: artifacts]
[2025-11-08 14:08:54,352: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage completed <<<<<<

x==========x]
[2025-11-08 14:10:22,080: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:10:22,082: INFO: common: created directory at: artifacts]
[2025-11-08 14:10:22,096: ERROR: stage_2_data_transformation: DataTransformation.transform_county_to_region() takes 1 positional argument but 2 were given]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 53, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 20, in main
    data_loaded = data_transformation.transform_county_to_region(data_loaded)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DataTransformation.transform_county_to_region() takes 1 positional argument but 2 were given
[2025-11-08 14:12:15,270: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:12:15,272: INFO: common: created directory at: artifacts]
[2025-11-08 14:12:15,292: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage completed <<<<<<

x==========x]
[2025-11-08 14:12:31,992: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:12:31,994: INFO: common: created directory at: artifacts]
[2025-11-08 14:12:32,015: ERROR: stage_2_data_transformation: Cannot use mean strategy with non-numeric data:
could not convert string to float: 'Within']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 53, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 43, in main
    data_imputed = data_transformation.impute_missing_values(data_loaded, numerical_features, categorical_features)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/data_transformation.py", line 73, in impute_missing_values
    data[feature] = imputer.fit_transform(data[[feature]])
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/base.py", line 894, in fit_transform
    return self.fit(X, **fit_params).transform(X)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/base.py", line 1365, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/impute/_base.py", line 452, in fit
    X = self._validate_input(X, in_fit=True)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/impute/_base.py", line 377, in _validate_input
    raise new_ve from None
ValueError: Cannot use mean strategy with non-numeric data:
could not convert string to float: 'Within'
[2025-11-08 14:13:56,069: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:13:56,071: INFO: common: created directory at: artifacts]
[2025-11-08 14:13:56,098: ERROR: stage_2_data_transformation: 2]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 54, in <module>
    obj.main()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_2_data_transformation.py", line 44, in main
    data_imputed = data_transformation.impute_missing_values(data_loaded, numerical_features, categorical_features)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/data_transformation.py", line 77, in impute_missing_values
    data[feature] = imputer.fit_transform(data[[feature]])
    ~~~~^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4322, in __setitem__
    self._set_item(key, value)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4535, in _set_item
    value, refs = self._sanitize_column(value)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 5289, in _sanitize_column
    arr = sanitize_array(value, self.index, copy=True, allow_2d=True)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/construction.py", line 604, in sanitize_array
    subarr = maybe_infer_to_datetimelike(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/dtypes/cast.py", line 1192, in maybe_infer_to_datetimelike
    raise ValueError(value.ndim)  # pragma: no cover
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: 2
[2025-11-08 14:18:40,822: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-08 14:18:40,825: INFO: common: created directory at: artifacts]
[2025-11-08 14:18:40,922: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage completed <<<<<<

x==========x]
[2025-11-08 16:49:32,466: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 16:49:32,467: ERROR: stage_3_model_training: while scanning a simple key
  in "config/config.yaml", line 42, column 3
could not find expected ':'
  in "config/config.yaml", line 43, column 3]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 16, in <module>
    config = ConfigurationManager()
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/config/configuration.py", line 13, in __init__
    self.config = read_yaml(config_filepath)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/ensure/main.py", line 872, in __call__
    return_val = self.f(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/utils/common.py", line 46, in read_yaml
    raise e
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/utils/common.py", line 40, in read_yaml
    content = yaml.safe_load(yaml_file)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/__init__.py", line 125, in safe_load
    return load(stream, SafeLoader)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/__init__.py", line 81, in load
    return loader.get_single_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/composer.py", line 64, in compose_node
    if self.check_event(AliasEvent):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
                         ^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/parser.py", line 449, in parse_block_mapping_value
    if not self.check_token(KeyToken, ValueToken, BlockEndToken):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/scanner.py", line 116, in check_token
    self.fetch_more_tokens()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/scanner.py", line 162, in fetch_more_tokens
    self.stale_possible_simple_keys()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/yaml/scanner.py", line 291, in stale_possible_simple_keys
    raise ScannerError("while scanning a simple key", key.mark,
yaml.scanner.ScannerError: while scanning a simple key
  in "config/config.yaml", line 42, column 3
could not find expected ':'
  in "config/config.yaml", line 43, column 3
[2025-11-08 16:53:22,795: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 16:53:22,799: INFO: common: created directory at: artifacts]
[2025-11-08 16:53:22,799: ERROR: stage_3_model_training: "'ConfigBox' object has no attribute 'transformed_data_file'"]
Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'transformed_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'transformed_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'transformed_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 17, in <module>
    model_trainer_config = config.get_model_trainer_config()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/config/configuration.py", line 49, in get_model_trainer_config
    transformed_data_file=config.transformed_data_file,
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "box/config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'transformed_data_file'"
[2025-11-08 17:52:19,538: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 17:52:19,542: INFO: common: created directory at: artifacts]
[2025-11-08 17:52:19,542: ERROR: stage_3_model_training: "'ConfigBox' object has no attribute 'transformed_data_file'"]
Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'transformed_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'transformed_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 594, in box.box.Box.__getitem__
KeyError: 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box/box.py", line 633, in box.box.Box.__getattr__
  File "box/box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'transformed_data_file'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box/box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'transformed_data_file'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 17, in <module>
    model_trainer_config = config.get_model_trainer_config()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/config/configuration.py", line 49, in get_model_trainer_config
    transformed_data_file=config.transformed_data_file,
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "box/config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box/box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'transformed_data_file'"
[2025-11-08 17:56:55,313: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 17:56:55,317: INFO: common: created directory at: artifacts]
[2025-11-08 17:56:55,325: ERROR: stage_3_model_training: 'ModelTrainer' object has no attribute 'models']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    best_model, score, reports = trainer.train_and_evaluate()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 32, in train_and_evaluate
    for name, model in self.models.items():
                       ^^^^^^^^^^^
AttributeError: 'ModelTrainer' object has no attribute 'models'
[2025-11-08 19:42:28,616: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 19:42:28,620: INFO: common: created directory at: artifacts]
[2025-11-08 19:56:22,077: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 19:56:22,080: INFO: common: created directory at: artifacts]
[2025-11-08 19:56:32,873: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 19:56:32,875: INFO: common: created directory at: artifacts]
[2025-11-08 19:56:32,883: ERROR: stage_3_model_training: 'ModelTrainer' object has no attribute 'models']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 47, in train_and_evaluate
    for name, model in self.models.items():
                       ^^^^^^^^^^^
AttributeError: 'ModelTrainer' object has no attribute 'models'
[2025-11-08 20:18:33,064: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:18:33,068: INFO: common: created directory at: artifacts]
[2025-11-08 20:18:33,080: ERROR: stage_3_model_training: 'ModelTrainer' object has no attribute 'models']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 47, in train_and_evaluate
    for name, model in self.models.items():
                       ^^^^^^^^^^^
AttributeError: 'ModelTrainer' object has no attribute 'models'
[2025-11-08 20:21:52,487: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:21:52,491: INFO: common: created directory at: artifacts]
[2025-11-08 20:21:52,500: ERROR: stage_3_model_training: 'ModelTrainer' object has no attribute 'models']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 47, in train_and_evaluate
    for name, model in self.models.items():
                       ^^^^^^^^^^^
AttributeError: 'ModelTrainer' object has no attribute 'models'
[2025-11-08 20:22:06,113: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:22:06,115: INFO: common: created directory at: artifacts]
[2025-11-08 20:23:06,083: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:23:06,086: INFO: common: created directory at: artifacts]
[2025-11-08 20:25:22,209: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:25:22,213: INFO: common: created directory at: artifacts]
[2025-11-08 20:25:22,222: ERROR: stage_3_model_training: 'ModelTrainer' object has no attribute 'models']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 46, in train_and_evaluate
    for name, model in self.models.items():
                       ^^^^^^^^^^^
AttributeError: 'ModelTrainer' object has no attribute 'models'
[2025-11-08 20:44:39,727: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:44:39,730: INFO: common: created directory at: artifacts]
[2025-11-08 20:44:39,740: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:44:39,740: ERROR: stage_3_model_training: 'dict' object has no attribute 'fit']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 45, in train_and_evaluate
    model.fit(X_train, y_train)
    ^^^^^^^^^
AttributeError: 'dict' object has no attribute 'fit'
[2025-11-08 20:46:45,466: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:46:45,469: INFO: common: created directory at: artifacts]
[2025-11-08 20:46:45,477: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:46:46,013: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:46:46,014: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:46:46,158: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:47:05,354: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:47:05,355: INFO: common: created directory at: artifacts]
[2025-11-08 20:47:05,360: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:47:05,897: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:47:05,897: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:47:06,033: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:47:06,033: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-08 20:47:06,033: ERROR: stage_3_model_training: 'ModelTrainerConfig' object has no attribute 'root_dir']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 72, in train_and_evaluate
    model_dir = Path(self.config.root_dir) / "models"
                     ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelTrainerConfig' object has no attribute 'root_dir'
[2025-11-08 20:54:15,195: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:54:15,198: INFO: common: created directory at: artifacts]
[2025-11-08 20:54:15,205: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:54:15,744: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:54:15,744: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:54:15,898: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:54:15,898: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-08 20:54:15,898: ERROR: stage_3_model_training: 'ModelTrainerConfig' object has no attribute 'model_save_path']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 75, in train_and_evaluate
    joblib.dump(best_model, self.config.model_save_path)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelTrainerConfig' object has no attribute 'model_save_path'
[2025-11-08 20:55:04,893: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:55:04,895: INFO: common: created directory at: artifacts]
[2025-11-08 20:55:04,913: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:55:05,457: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:55:05,457: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:55:05,601: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:55:05,601: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-08 20:55:05,601: ERROR: stage_3_model_training: [Errno 2] No such file or directory: 'artifacts/model_trainer/best_model.pkl']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 75, in train_and_evaluate
    joblib.dump(best_model, self.config.best_model_path)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/joblib/numpy_pickle.py", line 599, in dump
    with open(filename, "wb") as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'artifacts/model_trainer/best_model.pkl'
[2025-11-08 20:55:58,703: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:55:58,705: INFO: common: created directory at: artifacts]
[2025-11-08 20:55:58,713: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:55:59,254: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:55:59,254: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:55:59,390: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:55:59,390: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-08 20:55:59,390: ERROR: stage_3_model_training: [Errno 2] No such file or directory: 'artifacts/model_trainer/best_model.pkl']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 74, in train_and_evaluate
    pickle.dump(best_model, open(self.config.best_model_path, 'wb'))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'artifacts/model_trainer/best_model.pkl'
[2025-11-08 20:57:37,649: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:57:37,650: INFO: common: created directory at: artifacts]
[2025-11-08 20:57:37,654: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:57:38,188: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:57:38,188: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:57:38,322: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:57:38,322: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-08 20:57:38,323: ERROR: stage_3_model_training: [Errno 2] No such file or directory: 'artifacts/model/best_model.pkl']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 74, in train_and_evaluate
    pickle.dump(best_model, open(self.config.best_model_path, 'wb'))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'artifacts/model/best_model.pkl'
[2025-11-08 20:58:20,708: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-08 20:58:20,709: INFO: common: created directory at: artifacts]
[2025-11-08 20:58:20,714: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:58:21,275: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:58:21,275: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:58:21,412: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:58:21,412: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-08 20:58:21,415: INFO: model_trainer: Saved best model at: artifacts/models/best_model.pkl]
[2025-11-08 20:58:21,420: INFO: model_trainer: Training model: RandomForest]
[2025-11-08 20:58:21,984: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-08 20:58:21,984: INFO: model_trainer: Training model: XGBoost]
[2025-11-08 20:58:22,131: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-08 20:58:22,131: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-08 20:58:22,133: INFO: model_trainer: Saved best model at: artifacts/models/best_model.pkl]
[2025-11-08 20:58:22,133: INFO: stage_3_model_training: Best Model: XGBoost | F1 Score: 0.9120769494851595]
[2025-11-08 20:58:22,134: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage completed <<<<<<

x==========x]
[2025-11-09 08:13:10,897: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:13:10,900: INFO: common: created directory at: artifacts]
[2025-11-09 08:13:10,944: ERROR: stage_4_model_prediction: 'County']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'County'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 47, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 20, in preprocess_input
    df = self.data_transformation.transform_county_to_region(df)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/data_transformation.py", line 63, in transform_county_to_region
    df["Region"] = df['County'].apply(categorize_county)
                   ~~^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'County'
[2025-11-09 08:13:25,079: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:13:25,081: INFO: common: created directory at: artifacts]
[2025-11-09 08:13:25,116: ERROR: stage_4_model_prediction: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 407, in pandas_feature_info
    new_feature_types.append(_pandas_dtype_mapper[dtype.name])
                             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'object'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 48, in predict
    prediction = self.model.predict(df_preprocessed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1839, in predict
    class_probs = super().predict(
                  ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 2852, in inplace_predict
    data, fns, _ = _transform_pandas_df(data, enable_categorical)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 662, in _transform_pandas_df
    feature_names, feature_types = pandas_feature_info(
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 409, in pandas_feature_info
    _invalid_dataframe_dtype(data)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 372, in _invalid_dataframe_dtype
    raise ValueError(msg)
ValueError: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object
[2025-11-09 08:14:09,532: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:14:09,535: INFO: common: created directory at: artifacts]
[2025-11-09 08:14:09,582: ERROR: stage_4_model_prediction: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 407, in pandas_feature_info
    new_feature_types.append(_pandas_dtype_mapper[dtype.name])
                             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'object'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 48, in predict
    prediction = self.model.predict(df_preprocessed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1839, in predict
    class_probs = super().predict(
                  ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 2852, in inplace_predict
    data, fns, _ = _transform_pandas_df(data, enable_categorical)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 662, in _transform_pandas_df
    feature_names, feature_types = pandas_feature_info(
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 409, in pandas_feature_info
    _invalid_dataframe_dtype(data)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 372, in _invalid_dataframe_dtype
    raise ValueError(msg)
ValueError: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object
[2025-11-09 08:14:56,364: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:14:56,368: INFO: common: created directory at: artifacts]
[2025-11-09 08:14:56,416: ERROR: stage_4_model_prediction: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 407, in pandas_feature_info
    new_feature_types.append(_pandas_dtype_mapper[dtype.name])
                             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'object'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 48, in predict
    prediction = self.model.predict(df_preprocessed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1839, in predict
    class_probs = super().predict(
                  ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 2852, in inplace_predict
    data, fns, _ = _transform_pandas_df(data, enable_categorical)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 662, in _transform_pandas_df
    feature_names, feature_types = pandas_feature_info(
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 409, in pandas_feature_info
    _invalid_dataframe_dtype(data)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 372, in _invalid_dataframe_dtype
    raise ValueError(msg)
ValueError: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object
[2025-11-09 08:24:30,405: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-09 08:24:30,408: INFO: common: created directory at: artifacts]
[2025-11-09 08:24:30,495: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage completed <<<<<<

x==========x]
[2025-11-09 08:33:18,175: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage started <<<<<<]
[2025-11-09 08:33:18,178: INFO: common: created directory at: artifacts]
[2025-11-09 08:33:18,267: INFO: stage_2_data_transformation: >>>>>> stage Data Transformation stage completed <<<<<<

x==========x]
[2025-11-09 08:33:25,514: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:33:25,515: INFO: common: created directory at: artifacts]
[2025-11-09 08:33:25,940: ERROR: stage_4_model_prediction: 'PredictionPipeline' object has no attribute 'data_transformation']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 67, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 41, in preprocess_input
    df = self.data_transformation.transform_county_to_region(df)
         ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'PredictionPipeline' object has no attribute 'data_transformation'
[2025-11-09 08:33:57,027: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:33:57,030: INFO: common: created directory at: artifacts]
[2025-11-09 08:33:57,061: ERROR: stage_4_model_prediction: 'NoneType' object has no attribute 'reset_index']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 69, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 63, in preprocess_input
    df = self.scalarize_input(df, numerical_features)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 22, in scalarize_input
    input_data.drop(columns=numerical_features, inplace=True).reset_index(drop=True)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'reset_index'
[2025-11-09 08:35:15,856: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:35:15,859: INFO: common: created directory at: artifacts]
[2025-11-09 08:35:15,892: ERROR: stage_4_model_prediction: 'NoneType' object has no attribute 'reset_index']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 69, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 63, in preprocess_input
    df = self.scalarize_input(df, numerical_features)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 22, in scalarize_input
    input_data = input_data.drop(columns=numerical_features, inplace=True).reset_index(drop=True)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'reset_index'
[2025-11-09 08:36:26,558: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:36:26,560: INFO: common: created directory at: artifacts]
[2025-11-09 08:36:26,595: ERROR: stage_4_model_prediction: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- Solar Technoeconomic Intersection
]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 69, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 64, in preprocess_input
    df = self.encode_categorical_features(df, categorical_features)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 28, in encode_categorical_features
    encoded_data = encoder.transform(input_data[categorical_features])
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/preprocessing/_encoders.py", line 1043, in transform
    X_int, X_mask = self._transform(
                    ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/preprocessing/_encoders.py", line 201, in _transform
    _check_feature_names(self, X, reset=False)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2787, in _check_feature_names
    raise ValueError(message)
ValueError: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- Solar Technoeconomic Intersection

[2025-11-09 08:39:57,774: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-09 08:39:57,777: INFO: common: created directory at: artifacts]
[2025-11-09 08:39:57,788: INFO: model_trainer: Training model: RandomForest]
[2025-11-09 08:39:58,344: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-09 08:39:58,344: INFO: model_trainer: Training model: XGBoost]
[2025-11-09 08:39:58,491: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-09 08:39:58,498: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-09 08:39:58,500: INFO: model_trainer: Saved best model at: artifacts/models/best_model.pkl]
[2025-11-09 08:39:58,507: INFO: model_trainer: Training model: RandomForest]
[2025-11-09 08:39:59,088: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-09 08:39:59,088: INFO: model_trainer: Training model: XGBoost]
[2025-11-09 08:39:59,220: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-09 08:39:59,226: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-09 08:39:59,229: INFO: model_trainer: Saved best model at: artifacts/models/best_model.pkl]
[2025-11-09 08:39:59,229: INFO: stage_3_model_training: Best Model: XGBoost | F1 Score: 0.9120769494851595]
[2025-11-09 08:39:59,229: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage completed <<<<<<

x==========x]
[2025-11-09 08:40:43,982: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-09 08:40:43,984: INFO: common: created directory at: artifacts]
[2025-11-09 08:40:43,990: INFO: model_trainer: Training model: RandomForest]
[2025-11-09 08:40:44,530: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-09 08:40:44,530: INFO: model_trainer: Training model: XGBoost]
[2025-11-09 08:40:44,676: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-09 08:40:44,677: ERROR: stage_3_model_training: 'Series' object has no attribute 'columns']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 66, in train_and_evaluate
    print(y_train.columns)
          ^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Series' object has no attribute 'columns'
[2025-11-09 08:40:55,781: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-09 08:40:55,782: INFO: common: created directory at: artifacts]
[2025-11-09 08:40:55,789: INFO: model_trainer: Training model: RandomForest]
[2025-11-09 08:40:56,363: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-09 08:40:56,363: INFO: model_trainer: Training model: XGBoost]
[2025-11-09 08:40:56,519: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-09 08:40:56,519: ERROR: stage_3_model_training: 'Series' object has no attribute 'columns']
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_3_model_training.py", line 20, in <module>
    trainer.train_and_evaluate()
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_trainer.py", line 66, in train_and_evaluate
    print(y_train.columns)
          ^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Series' object has no attribute 'columns'
[2025-11-09 08:41:04,515: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage started <<<<<<]
[2025-11-09 08:41:04,517: INFO: common: created directory at: artifacts]
[2025-11-09 08:41:04,522: INFO: model_trainer: Training model: RandomForest]
[2025-11-09 08:41:05,099: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-09 08:41:05,099: INFO: model_trainer: Training model: XGBoost]
[2025-11-09 08:41:05,240: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-09 08:41:05,240: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-09 08:41:05,244: INFO: model_trainer: Saved best model at: artifacts/models/best_model.pkl]
[2025-11-09 08:41:05,251: INFO: model_trainer: Training model: RandomForest]
[2025-11-09 08:41:05,823: INFO: model_trainer: RandomForest F1 Score: 0.9080]
[2025-11-09 08:41:05,823: INFO: model_trainer: Training model: XGBoost]
[2025-11-09 08:41:05,954: INFO: model_trainer: XGBoost F1 Score: 0.9121]
[2025-11-09 08:41:05,954: INFO: model_trainer: Best model: XGBoost | F1 Score: 0.9121]
[2025-11-09 08:41:05,956: INFO: model_trainer: Saved best model at: artifacts/models/best_model.pkl]
[2025-11-09 08:41:05,956: INFO: stage_3_model_training: Best Model: XGBoost | F1 Score: 0.9120769494851595]
[2025-11-09 08:41:05,956: INFO: stage_3_model_training: >>>>>> Stage Model Training Stage completed <<<<<<

x==========x]
[2025-11-09 08:53:48,667: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 08:53:48,670: INFO: common: created directory at: artifacts]
[2025-11-09 08:53:48,708: ERROR: stage_4_model_prediction: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- Solar Technoeconomic Intersection
]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 71, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 66, in preprocess_input
    df = self.encode_categorical_features(df, categorical_features)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 30, in encode_categorical_features
    encoded_data = encoder.transform(input_data[categorical_features])
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/preprocessing/_encoders.py", line 1043, in transform
    X_int, X_mask = self._transform(
                    ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/preprocessing/_encoders.py", line 201, in _transform
    _check_feature_names(self, X, reset=False)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2787, in _check_feature_names
    raise ValueError(message)
ValueError: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- Solar Technoeconomic Intersection

[2025-11-09 09:00:16,548: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:00:16,550: INFO: common: created directory at: artifacts]
[2025-11-09 09:00:16,584: ERROR: stage_4_model_prediction: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- Solar Technoeconomic Intersection
]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 72, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 67, in preprocess_input
    df = self.encode_categorical_features(df, categorical_features)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 30, in encode_categorical_features
    encoded_data = encoder.transform(input_data[categorical_features])
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/preprocessing/_encoders.py", line 1043, in transform
    X_int, X_mask = self._transform(
                    ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/preprocessing/_encoders.py", line 201, in _transform
    _check_feature_names(self, X, reset=False)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2787, in _check_feature_names
    raise ValueError(message)
ValueError: The feature names should match those that were passed during fit.
Feature names seen at fit time, yet now missing:
- Solar Technoeconomic Intersection

[2025-11-09 09:01:03,418: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:01:03,420: INFO: common: created directory at: artifacts]
[2025-11-09 09:01:03,440: ERROR: stage_4_model_prediction: input_features is not equal to feature_names_in_]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 72, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 67, in preprocess_input
    df = self.encode_categorical_features(df, categorical_features)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 32, in encode_categorical_features
    encoded_df = pd.DataFrame(encoded_data, columns=encoder.get_feature_names_out(categorical_features))
                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/preprocessing/_encoders.py", line 1227, in get_feature_names_out
    input_features = _check_feature_names_in(self, input_features)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2478, in _check_feature_names_in
    raise ValueError("input_features is not equal to feature_names_in_")
ValueError: input_features is not equal to feature_names_in_
[2025-11-09 09:02:35,716: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:02:35,719: INFO: common: created directory at: artifacts]
[2025-11-09 09:02:35,751: ERROR: stage_4_model_prediction: cannot concatenate object of type '<class 'numpy.ndarray'>'; only Series and DataFrame objs are valid]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 71, in predict
    df_preprocessed = self.preprocess_input(input_data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 66, in preprocess_input
    df = self.encode_categorical_features(df, categorical_features)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 32, in encode_categorical_features
    input_data = pd.concat([input_data, encoded_data], axis=1)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/reshape/concat.py", line 382, in concat
    op = _Concatenator(
         ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/reshape/concat.py", line 448, in __init__
    ndims = self._get_ndims(objs)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/pandas/core/reshape/concat.py", line 489, in _get_ndims
    raise TypeError(msg)
TypeError: cannot concatenate object of type '<class 'numpy.ndarray'>'; only Series and DataFrame objs are valid
[2025-11-09 09:04:05,130: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:04:05,132: INFO: common: created directory at: artifacts]
[2025-11-09 09:04:05,155: ERROR: stage_4_model_prediction: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object, Solar Technoeconomic Intersection: object]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 407, in pandas_feature_info
    new_feature_types.append(_pandas_dtype_mapper[dtype.name])
                             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'object'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 73, in predict
    prediction = self.model.predict(df_preprocessed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1839, in predict
    class_probs = super().predict(
                  ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 2852, in inplace_predict
    data, fns, _ = _transform_pandas_df(data, enable_categorical)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 662, in _transform_pandas_df
    feature_names, feature_types = pandas_feature_info(
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 409, in pandas_feature_info
    _invalid_dataframe_dtype(data)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/data.py", line 372, in _invalid_dataframe_dtype
    raise ValueError(msg)
ValueError: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:County: object, Solar Technoeconomic Intersection: object
[2025-11-09 09:06:33,062: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:06:33,065: INFO: common: created directory at: artifacts]
[2025-11-09 09:06:33,114: INFO: stage_4_model_prediction: Prediction Output: 0]
[2025-11-09 09:06:33,114: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage completed <<<<<<

x==========x]
[2025-11-09 09:09:53,235: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:09:53,237: INFO: common: created directory at: artifacts]
[2025-11-09 09:09:53,279: INFO: stage_4_model_prediction: Prediction Output: 0]
[2025-11-09 09:09:53,279: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage completed <<<<<<

x==========x]
[2025-11-09 09:11:11,466: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:11:11,469: INFO: common: created directory at: artifacts]
[2025-11-09 09:11:11,505: INFO: stage_4_model_prediction: Prediction Output: 0]
[2025-11-09 09:11:11,505: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage completed <<<<<<

x==========x]
[2025-11-09 09:14:49,583: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:14:49,587: INFO: common: created directory at: artifacts]
[2025-11-09 09:14:49,626: INFO: stage_4_model_prediction: Prediction Output: 0]
[2025-11-09 09:14:49,627: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage completed <<<<<<

x==========x]
[2025-11-09 09:15:38,251: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:15:38,252: INFO: common: created directory at: artifacts]
[2025-11-09 09:15:38,277: ERROR: stage_4_model_prediction: feature_names mismatch: ['Acres', 'Distance to Substation (Miles) CAISO', 'Distance to Substation (Miles) GTET 100 Max Voltage', 'Distance to Substation (Miles) GTET 200 Max Voltage', 'Shape__Length', 'Shape__Area', 'Percentile (GTET 100 Max Voltage)_25th to 50th', 'Percentile (GTET 100 Max Voltage)_50th to 75th', 'Percentile (GTET 100 Max Voltage)_75th to 100th', 'Percentile (GTET 200 Max Voltage)_25th to 50th', 'Percentile (GTET 200 Max Voltage)_50th to 75th', 'Percentile (GTET 200 Max Voltage)_75th to 100th', 'Percentile (CAISO)_25th to 50th', 'Percentile (CAISO)_50th to 75th', 'Percentile (CAISO)_75th to 100th', 'Install Type_Parking', 'Install Type_Rooftop', 'Urban or Rural_Urban', 'Region_Central California', 'Region_Inland Deserts', 'Region_North Central California', 'Region_Northern California', 'Region_South Coast'] ['Distance to Substation (Miles) GTET 100 Max Voltage', 'Distance to Substation (Miles) GTET 200 Max Voltage', 'Distance to Substation (Miles) CAISO', 'Shape__Length', 'Acres', 'Shape__Area', 'Percentile (GTET 100 Max Voltage)_25th to 50th', 'Percentile (GTET 100 Max Voltage)_50th to 75th', 'Percentile (GTET 100 Max Voltage)_75th to 100th', 'Percentile (GTET 200 Max Voltage)_25th to 50th', 'Percentile (GTET 200 Max Voltage)_50th to 75th', 'Percentile (GTET 200 Max Voltage)_75th to 100th', 'Percentile (CAISO)_25th to 50th', 'Percentile (CAISO)_50th to 75th', 'Percentile (CAISO)_75th to 100th', 'Install Type_Parking', 'Install Type_Rooftop', 'Urban or Rural_Urban', 'Region_Central California', 'Region_Inland Deserts', 'Region_North Central California', 'Region_Northern California', 'Region_South Coast']]
Traceback (most recent call last):
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/pipeline/stage_4_model_prediction.py", line 32, in <module>
    prediction = pipeline.predict(input_sample)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/src/Classifier/components/model_prediction.py", line 79, in predict
    prediction = self.model.predict(df_preprocessed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1839, in predict
    class_probs = super().predict(
                  ^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 2854, in inplace_predict
    self._validate_features(fns)
  File "/Users/umeaimanmerchant/Documents/ml_pipeline/venv/lib/python3.12/site-packages/xgboost/core.py", line 3431, in _validate_features
    raise ValueError(msg.format(self.feature_names, feature_names))
ValueError: feature_names mismatch: ['Acres', 'Distance to Substation (Miles) CAISO', 'Distance to Substation (Miles) GTET 100 Max Voltage', 'Distance to Substation (Miles) GTET 200 Max Voltage', 'Shape__Length', 'Shape__Area', 'Percentile (GTET 100 Max Voltage)_25th to 50th', 'Percentile (GTET 100 Max Voltage)_50th to 75th', 'Percentile (GTET 100 Max Voltage)_75th to 100th', 'Percentile (GTET 200 Max Voltage)_25th to 50th', 'Percentile (GTET 200 Max Voltage)_50th to 75th', 'Percentile (GTET 200 Max Voltage)_75th to 100th', 'Percentile (CAISO)_25th to 50th', 'Percentile (CAISO)_50th to 75th', 'Percentile (CAISO)_75th to 100th', 'Install Type_Parking', 'Install Type_Rooftop', 'Urban or Rural_Urban', 'Region_Central California', 'Region_Inland Deserts', 'Region_North Central California', 'Region_Northern California', 'Region_South Coast'] ['Distance to Substation (Miles) GTET 100 Max Voltage', 'Distance to Substation (Miles) GTET 200 Max Voltage', 'Distance to Substation (Miles) CAISO', 'Shape__Length', 'Acres', 'Shape__Area', 'Percentile (GTET 100 Max Voltage)_25th to 50th', 'Percentile (GTET 100 Max Voltage)_50th to 75th', 'Percentile (GTET 100 Max Voltage)_75th to 100th', 'Percentile (GTET 200 Max Voltage)_25th to 50th', 'Percentile (GTET 200 Max Voltage)_50th to 75th', 'Percentile (GTET 200 Max Voltage)_75th to 100th', 'Percentile (CAISO)_25th to 50th', 'Percentile (CAISO)_50th to 75th', 'Percentile (CAISO)_75th to 100th', 'Install Type_Parking', 'Install Type_Rooftop', 'Urban or Rural_Urban', 'Region_Central California', 'Region_Inland Deserts', 'Region_North Central California', 'Region_Northern California', 'Region_South Coast']
[2025-11-09 09:23:23,931: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage started <<<<<<]
[2025-11-09 09:23:23,934: INFO: common: created directory at: artifacts]
[2025-11-09 09:23:23,975: INFO: stage_4_model_prediction: Prediction Output: 0]
[2025-11-09 09:23:23,975: INFO: stage_4_model_prediction: >>>>>> stage Prediction Stage completed <<<<<<

x==========x]
[2025-11-09 09:33:18,268: INFO: utils: NumExpr defaulting to 8 threads.]
[2025-11-09 09:34:32,451: INFO: utils: NumExpr defaulting to 8 threads.]
[2025-11-09 09:40:38,169: INFO: utils: NumExpr defaulting to 8 threads.]
[2025-11-09 09:41:17,081: INFO: utils: NumExpr defaulting to 8 threads.]
[2025-11-09 09:42:16,776: INFO: utils: NumExpr defaulting to 8 threads.]
[2025-11-09 09:43:58,508: ERROR: utils: Form data requires "python-multipart" to be installed. 
You can install "python-multipart" with: 

pip install python-multipart
]
[2025-11-10 08:29:30,868: INFO: common: created directory at: artifacts]
[2025-11-10 08:35:04,168: INFO: common: created directory at: artifacts]
[2025-11-10 08:55:54,826: INFO: common: created directory at: artifacts]
[2025-11-10 08:57:25,487: INFO: common: created directory at: artifacts]
